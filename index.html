<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style type="text/css">
      code, pre {
        background-color: #6666;
        padding: 2px;
      }
      pre code {
        background-color: #0000;
        padding: 0px;
      }
    </style>
    <style type="text/css" media="(prefers-color-scheme: light)">
    </style>
    <style type="text/css" media="(prefers-color-scheme: dark)">
      body {background-color: black; color: white;}
      a {filter: invert(1) brightness(0.5) invert(1);}
      select, button {filter: invert(1);}
    </style>
    <script src="https://cdn.rawgit.com/showdownjs/showdown/1.9.1/dist/showdown.min.js"></script>
    <script>
      readme = 'README.md'
      converter = new showdown.Converter();
      html = converter.makeHtml('loading ``' + readme + '`` ...');

      function reqListener () {
        if ((this.status >= 200 && this.status < 300) || this.status == 304)  {
          html = converter.makeHtml(this.responseText);
        }else{
          html += "Status " + this.status;
          console.log(this);
        }
        document.getElementById('readme').innerHTML = html;
        document.title = document.getElementById('readme').children[0].innerText;
        if(location.href.split('#').length > 1){location.href=location.href}
      }

      cssAlways = document.styleSheets[0].media;
      cssLight = document.styleSheets[1].media;
      cssDark = document.styleSheets[2].media;

      miniMenuHTML = '<button style="float:right;" onclick="toggleMenu()">â˜°</button>';
      bigMenuHTML = '<select id="theme"><option value="a">auto</option><option value="d">dark</option><option value="l">light</option></select>';
      bigMenuHTML += '<br /><select id="text-width" style="width: 100%"><option value="f">full-width</option><option value="r">readable</option></select>';
      bigMenuHTML += '<br /><select id="font-family" style="width: 100%"><option value="s">serif</option><option value="n">sans-serif</option><option value="m">monospace</option></select>';
      function toggleMenu () {
        var mDiv = document.getElementById('indexmdmenu');
        if (mDiv.innerHTML == miniMenuHTML) {
          mDiv.innerHTML += bigMenuHTML;
        }else{
          mDiv.innerHTML = miniMenuHTML;
        }
      }

      function menuEffect() {
        console.log('menu has changed');
      }

      function main() {
        toggleMenu();
        oReq = new XMLHttpRequest();
        oReq.addEventListener("load", reqListener);
        oReq.open("GET", readme);
        oReq.send();
      }
    </script>
	</head>
  <body onload="main()">
    <div id="indexmdmenu" style="float:right; max-width: 30vw; border: dotted" onchange="menuEffect()"></div>
    <div id="readme"></div>
	</body>
</html>

